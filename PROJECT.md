# Python-101 SPECIFICATION

## 1. 项目概览
- **项目名称**：Python学习题库（交互式入门教程）
- **目标受众**：0 编程基础的中文用户，希望通过互动方式掌握 Python 基础语法。
- **项目形态**：网页应用，包含教程阅读、题库练习与在线代码运行。
- **核心目标**：提供循序渐进的 Python 知识讲解与配套练习，借助 LLM 判题实现自动批改与引导式提示。

## 2. 学习体验设计
- **学习路径**：
  - 用户可以自由选择章节，也可以按教程引导顺序学习。
  - 教程模式：每章按页面展示知识点，页面底部提供“下一页”导航；章节最后一页跳转至本章习题。
  - 题库模式：独立的题库选项卡，可按章节与难度筛选题目直接练习。
- **章节与题量**：覆盖变量、数据类型、列表元组、if 语句、字典、输入与 while 循环、函数、类、文件等主题。每章至少 5 道题。
- **难度分层**：题目标记为“基础 / 进阶 / 挑战”。用户在题库中可按难度筛选。
- **内容深度**：每个知识点配示例代码，可选“常见错误”“进阶拓展”模块。
- **语言规范**：界面与讲解使用中文，Python 术语（如 list）保持英文，并提供悬浮解释弹窗。

## 3. 题型与讲解要求
- **题型范围**：判断题、单选题（默认 4 个选项）、编程题。暂不支持多选或填空。
- **题目风格**：题干描述生活化，避免生硬学术语句。
- **题目结构**：
  - 必须包含题目正文、所属章节、难度标签、默认内存限制（8MB，可覆盖）、是否可在教程/题库中出现。
  - 讲解需包含：正确答案/示例解法、常见错误、进阶拓展（如适用）。
- **存储规范**：所有教程内容和习题以 Markdown/结构化文件存放在 `resources/` 下，需定义可维护的子目录命名（例如 `resources/chapters/<chapter-slug>.md` 与 `resources/questions/<chapter>/<question-slug>.md`）。

## 4. 在线编程与判题
- **Python 版本**：锁定为 3.8。
- **执行环境**：
  - 仅允许标准库。
  - 运行时间上限 30 秒。
  - 默认内存限制 8 MB，可按题目配置值覆盖。
  - 沙箱必须禁止外部网络访问；限制文件写入路径（仅允许预设工作目录）与 CPU 占用；必要时对危险系统调用进行拦截。
- **LLM 判题**：
  - 使用火山引擎豆包 `doubao-seed-1.6-250615` 模型。
  - Demo 代码（需配 `.env`，`load_dotenv` 加载 `ARK_API_KEY`）：
    ```python
    import os
    from dotenv import load_dotenv
    from volcenginesdkarkruntime import Ark

    load_dotenv()
    SYS_PROMPT = """[system prompt]"""
    prompt = """[user prompt]"""

    client = Ark(api_key=os.environ.get("ARK_API_KEY"), timeout=1800)
    response = client.chat.completions.create(
        model="doubao-seed-1.6-250615",
        messages=[
            {"role": "system", "content": SYS_PROMPT},
            {"role": "user", "content": prompt}
        ],
        thinking={"type": "disabled"},
        temperature=0.6,
    )
    ```
  - 判题策略：必须完全正确才算通过；提示以循序渐进、分步引导为主，不直接给出最终答案；单题单轮对话，用户提交代码后返回结果与提示。

## 5. UI 与交互
- **主要视图**：教程页面、题库页面、在线运行与判题界面、学习进度记录页、登录页、后台管理页。
- **特效**：答对题目时触发 3 秒彩炮动画，效果应轻量且不阻挡用户交互。
- **可访问性**：保证彩炮可快速结束，不影响继续提交或导航。

## 6. 用户与设备管理
- **认证方式**：账号 + 密码登录（中文界面）。
- **存储**：用户账户信息、设备列表、进度记录等存于本地 JSON 文件（加入 `.gitignore` 防止入库）。密码暂存明文（后续可升级加密方案）。
- **设备限制**：
  - 每个账号最多登录 3 台设备。
  - 记录设备名、浏览器、登录时间（不记录 IP）。
  - 后台展示用户设备信息，并允许管理员手动移除设备。
  - 删除设备需要二次确认，无需短信验证码。
- **学习数据**：
  - 保存题目层级的完成状态和得分；无需记录耗时或导出功能。
  - 提供“学习记录”页面查看章节与题库进度。

## 7. 后台管理
- **角色权限**：仅管理员角色可访问后台。
- **功能点**：
  - 管理章节内容：增删改章节、排序、关联 Markdown 资源。
  - 管理题目：增删改题干、难度、内存限制、题型、解析模块等。
  - 管理用户：查看基本信息、学习进度、设备列表；可调整设备限制和清理登录记录。
  - 配置持久化：所有后台操作需写回资源或配置文件，确保版本化与可扩展性。

## 8. 文件与目录约定
- `resources/chapters/`：章节内容 Markdown，命名建议 `NN-topic.md`（保留顺序与 slug）。
- `resources/questions/`：题目定义，可按章节子目录组织，每题使用独立文件，包含题干、答案、解析、限制等字段。
- `resources/config/`（可选）：存放题目元数据索引、内存限制默认值等配置。后续实现时可结合 JSON/YAML 结构以便解析。
- `data/`（加入 `.gitignore`）：存储用户账户、设备记录、学习进度与提交历史的 JSON 文件。

## 9. 开发与部署注意事项
- **依赖管理**：确保使用与 Python 3.8 兼容的依赖。对 LLM 接口使用 `.env` 管理凭证。
- **安全策略**：
  - 沙箱执行器需阻止危险操作（网络、任意文件写入、高 CPU）。
  - 处理用户输入时需防止无限循环或资源滥用（可结合超时与资源配额）。
- **扩展性**：
  - 教程与题目内容通过文件驱动，方便非工程人员协作维护。
  - 后台操作应尽量抽象为脚本/管理界面，避免手动编辑源文件时出错。

## 10. 待完善事项
- 定义具体的资源文件数据格式（字段、示例）。
- 设计判题沙箱的技术选型与实现细节（如 Docker、Firejail）。
- 规划前后端技术栈与组件划分。
- 明文密码的过渡策略（例如后续使用哈希）。
- 彩炮动效的实现方案与性能测试。

以上规范是后续实现与协作的主要依据，更新需求时需同步修订本文件。
